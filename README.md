# react-native-safety-check

Root or Jailbreak detection lib react native

## Installation

```sh
npm install react-native-safety-check
```

### Android Autolinking

Autolinking doesnâ€™t work with the new architecture out of the box. Therefore you need to ask the user of your library to do the following steps:

1. Open the `<your-source-dir>/android/app/build.gradle` file and update the file as it follows:

    ```diff
        "PROJECT_BUILD_DIR=$buildDir",
        "REACT_ANDROID_DIR=$rootDir/../node_modules/react-native/ReactAndroid",
    -   "REACT_ANDROID_BUILD_DIR=$rootDir/../node_modules/react-native/ReactAndroid/build"
    +   "REACT_ANDROID_BUILD_DIR=$rootDir/../node_modules/react-native/ReactAndroid/build",
    +   "NODE_MODULES_DIR=$rootDir/../node_modules/"
        cFlags "-Wall", "-Werror", "-fexceptions", "-frtti", "-DWITH_INSPECTOR=1"
        cppFlags "-std=c++17"
    ```

1. Open the `<your-source-dir>/android/app/src/main/jni/Android.mk` file and update the file as it follows:

    ```diff
        # If you wish to add a custom TurboModule or Fabric component in your app you
        # will have to include the following autogenerated makefile.
        # include $(GENERATED_SRC_DIR)/codegen/jni/Android.mk
    +
    +   # Includes the MK file for `react-native-safety-check`
    +
    +   include $(NODE_MODULES_DIR)/react-native-safety-check/android/build/generated/source/codegen/jni/Android.mk
        include $(CLEAR_VARS)
    ```

1. In the same file above, go to the `LOCAL_SHARED_LIBRARIES` setting and add the following line:

    ```diff
        libreact_codegen_rncore \
    +   libreact_codegen_SafetyCheck \
        libreact_debug \
    ```

1. Open the `NewArchitecture/android/app/src/main/jni/MainApplicationModuleProvider.cpp` file and update the file as it follows:
    1. Add the import for the SafetyCheck:

        ```diff
            #include <answersolver.h>
        +   #include <SafetyCheck.h>
        ```

    1. Add the following check in the `MainApplicationModuleProvider` constructor:

        ```diff
            // auto module = samplelibrary_ModuleProvider(moduleName, params);
            // if (module != nullptr) {
            //    return module;
            // }

        +    auto module = SafetyCheck_ModuleProvider(moduleName, params);
        +    if (module != nullptr) {
        +        return module;
        +    }

            return rncore_ModuleProvider(moduleName, params);
        }
        ```

## Usage

```js
import { multiply } from "react-native-safety-check";

// ...

const result = await multiply(3, 7);
```

## Contributing

See the [contributing guide](CONTRIBUTING.md) to learn how to contribute to the repository and the development workflow.

## License

MIT

---

Made with [create-react-native-library](https://github.com/callstack/react-native-builder-bob)
